<!DOCTYPE html>
<html><head>
<meta name="google-site-verification" content="XrwF-xUZWSGJVBBm7jM8vqemVqx--zo5Tb9d-Vr7BCc" />
<title>觸發器Trigger</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="尚硅谷MySQL筆記-13">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="觸發器Trigger" />
<meta property="og:description" content="尚硅谷MySQL筆記-13" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yoziming.github.io/post/211228-agg-mysql-13/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-12-28T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-12-28T00:00:00+00:00" /><meta property="og:site_name" content="My Blog" />






<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="觸發器Trigger"/>
<meta name="twitter:description" content="尚硅谷MySQL筆記-13"/>







<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  




<link rel="icon" href="https://yoziming.github.io/images/favicon.png">



<link rel="stylesheet" href="https://yoziming.github.io/scss/journal.min.3f72a5fc8f5b5dd732a4b476aced0eece2156958d9d414316494ddb10593ddf7.css" integrity="sha256-P3Kl/I9bXdcypLR2rO0O7OIVaVjZ1BQxZJTdsQWT3fc=" media="screen">



<link rel="stylesheet" href="https://yoziming.github.io/scss/dark-mode.min.f7c2efa7183435a6bd1842f91c541481c7a5137b5991629a870f24e4a516ad4b.css" integrity="sha256-98Lvpxg0Naa9GEL5HFQUgcelE3tZkWKahw8k5KUWrUs=" media="screen">


<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons");
</script>






  <script src="/js/toc.js"></script>











<script src="//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js"></script>





</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://yoziming.github.io/">
    
        <div class="nav-title">
            柚子茶室
        </div>
        
        <div class="nav-subtitle">
            紀錄自學大小事
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/">
                首頁🏠
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                標籤🏷️
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                系列文📖
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/about-me">
                關於我🐣
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Yoziming
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- 目錄 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%a7%b8%e7%99%bc%e5%99%a8trigger" onclick="onNavClick(`#觸發器trigger-nav`)" id="觸發器trigger-nav">
									觸發器Trigger
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-%e8%a7%b8%e7%99%bc%e5%99%a8%e6%a6%82%e8%bf%b0" onclick="onNavClick(`#1-觸發器概述-nav`)" id="1-觸發器概述-nav">
									1. 觸發器概述
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-%e8%a7%b8%e7%99%bc%e5%99%a8%e7%9a%84%e5%89%b5%e5%bb%ba" onclick="onNavClick(`#2-觸發器的創建-nav`)" id="2-觸發器的創建-nav">
									2. 觸發器的創建
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#21-%e5%89%b5%e5%bb%ba%e8%a7%b8%e7%99%bc%e5%99%a8%e8%aa%9e%e6%b3%95" onclick="onNavClick(`#21-創建觸發器語法-nav`)" id="21-創建觸發器語法-nav">
									2.1 創建觸發器語法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#22-%e4%bb%a3%e7%a2%bc%e8%88%89%e4%be%8b" onclick="onNavClick(`#22-代碼舉例-nav`)" id="22-代碼舉例-nav">
									2.2 代碼舉例
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#3-%e6%9f%a5%e7%9c%8b%e5%88%aa%e9%99%a4%e8%a7%b8%e7%99%bc%e5%99%a8" onclick="onNavClick(`#3-查看刪除觸發器-nav`)" id="3-查看刪除觸發器-nav">
									3. 查看、刪除觸發器
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#31-%e6%9f%a5%e7%9c%8b%e8%a7%b8%e7%99%bc%e5%99%a8" onclick="onNavClick(`#31-查看觸發器-nav`)" id="31-查看觸發器-nav">
									3.1 查看觸發器
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#32-%e5%88%aa%e9%99%a4%e8%a7%b8%e7%99%bc%e5%99%a8" onclick="onNavClick(`#32-刪除觸發器-nav`)" id="32-刪除觸發器-nav">
									3.2 刪除觸發器
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#4-%e8%a7%b8%e7%99%bc%e5%99%a8%e7%9a%84%e5%84%aa%e7%bc%ba%e9%bb%9e" onclick="onNavClick(`#4-觸發器的優缺點-nav`)" id="4-觸發器的優缺點-nav">
									4. 觸發器的優缺點
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#41-%e5%84%aa%e9%bb%9e" onclick="onNavClick(`#41-優點-nav`)" id="41-優點-nav">
									4.1 優點
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#42-%e7%bc%ba%e9%bb%9e" onclick="onNavClick(`#42-缺點-nav`)" id="42-缺點-nav">
									4.2 缺點
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#43-%e6%b3%a8%e6%84%8f%e9%bb%9e" onclick="onNavClick(`#43-注意點-nav`)" id="43-注意點-nav">
									4.3 注意點
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/">
                    首頁🏠
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    標籤🏷️
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    系列文📖
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/about-me">
                    關於我🐣
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目錄 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%a7%b8%e7%99%bc%e5%99%a8trigger" onclick="onNavClick(`#觸發器trigger-nav`)" id="觸發器trigger-nav">
									觸發器Trigger
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-%e8%a7%b8%e7%99%bc%e5%99%a8%e6%a6%82%e8%bf%b0" onclick="onNavClick(`#1-觸發器概述-nav`)" id="1-觸發器概述-nav">
									1. 觸發器概述
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#2-%e8%a7%b8%e7%99%bc%e5%99%a8%e7%9a%84%e5%89%b5%e5%bb%ba" onclick="onNavClick(`#2-觸發器的創建-nav`)" id="2-觸發器的創建-nav">
									2. 觸發器的創建
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#21-%e5%89%b5%e5%bb%ba%e8%a7%b8%e7%99%bc%e5%99%a8%e8%aa%9e%e6%b3%95" onclick="onNavClick(`#21-創建觸發器語法-nav`)" id="21-創建觸發器語法-nav">
									2.1 創建觸發器語法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#22-%e4%bb%a3%e7%a2%bc%e8%88%89%e4%be%8b" onclick="onNavClick(`#22-代碼舉例-nav`)" id="22-代碼舉例-nav">
									2.2 代碼舉例
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#3-%e6%9f%a5%e7%9c%8b%e5%88%aa%e9%99%a4%e8%a7%b8%e7%99%bc%e5%99%a8" onclick="onNavClick(`#3-查看刪除觸發器-nav`)" id="3-查看刪除觸發器-nav">
									3. 查看、刪除觸發器
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#31-%e6%9f%a5%e7%9c%8b%e8%a7%b8%e7%99%bc%e5%99%a8" onclick="onNavClick(`#31-查看觸發器-nav`)" id="31-查看觸發器-nav">
									3.1 查看觸發器
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#32-%e5%88%aa%e9%99%a4%e8%a7%b8%e7%99%bc%e5%99%a8" onclick="onNavClick(`#32-刪除觸發器-nav`)" id="32-刪除觸發器-nav">
									3.2 刪除觸發器
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#4-%e8%a7%b8%e7%99%bc%e5%99%a8%e7%9a%84%e5%84%aa%e7%bc%ba%e9%bb%9e" onclick="onNavClick(`#4-觸發器的優缺點-nav`)" id="4-觸發器的優缺點-nav">
									4. 觸發器的優缺點
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#41-%e5%84%aa%e9%bb%9e" onclick="onNavClick(`#41-優點-nav`)" id="41-優點-nav">
									4.1 優點
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#42-%e7%bc%ba%e9%bb%9e" onclick="onNavClick(`#42-缺點-nav`)" id="42-缺點-nav">
									4.2 缺點
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#43-%e6%b3%a8%e6%84%8f%e9%bb%9e" onclick="onNavClick(`#43-注意點-nav`)" id="43-注意點-nav">
									4.3 注意點
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://yoziming.github.io/">
            柚子茶室
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://yoziming.github.io/">
        <div class="single-column-header-title">柚子茶室</div>
        
        <div class="single-column-header-subtitle">紀錄自學大小事</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://yoziming.github.io/images/mysql.jpg')"
                    
                
            >
                <div class="post-title">
                    觸發器Trigger
                    
                    <div class="post-subtitle">
                        尚硅谷MySQL筆記-13
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2021-12-28 00:00
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/mysql%E7%B7%9A%E4%B8%8A%E8%AA%B2">MySQL線上課</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/sql">SQL</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h1 id="觸發器trigger">觸發器Trigger</h1>
<blockquote>
<p>一樣跳過</p>
</blockquote>
<p>在實際開發中，我們經常會遇到這樣的情況：有 2 個或者多個相互關聯的表，如<code>商品資訊</code>和<code>庫存資訊</code>分別存放在 2 個不同的資料表中，我們在添加一條新商品記錄的時候，為了保證資料的完整性，必須同時在庫存表中添加一條庫存記錄。</p>
<p>這樣一來，我們就必須把這兩個關聯的操作步驟寫到程式裡面，而且要用<code>事務</code>包裹起來，確保這兩個操作成為一個<code>原子操作</code>，要麼全部執行，要麼全部不執行。要是遇到特殊情況，可能還需要對資料進行手動維護，這樣就很<code>容易忘記其中的一步</code>，導致資料缺失。</p>
<p>這個時候，咱們可以使用觸發器。**你可以創建一個觸發器，讓商品資訊資料的插入操作自動觸發庫存資料的插入操作。**這樣一來，就不用擔心因為忘記添加庫存資料而導致的資料缺失了。</p>
<h2 id="1-觸發器概述">1. 觸發器概述</h2>
<p>MySQL從<code>5.0.2</code>版本開始支持觸發器。MySQL的觸發器和存儲過程一樣，都是嵌入到MySQL伺服器的一段程式。</p>
<p>觸發器是由<code>事件來觸發</code>某個操作，這些事件包括<code>INSERT</code>、<code>UPDATE</code>、<code>DELETE</code>事件。所謂事件就是指用戶的動作或者觸發某項行為。如果定義了觸發程式，當資料庫執行這些語句時候，就相當於事件發生了，就會<code>自動</code>激發觸發器執行相應的操作。</p>
<p>當對資料表中的資料執行插入、更新和刪除操作，需要自動執行一些資料庫邏輯時，可以使用觸發器來實現。</p>
<h2 id="2-觸發器的創建">2. 觸發器的創建</h2>
<h3 id="21-創建觸發器語法">2.1 創建觸發器語法</h3>
<p>創建觸發器的語法結構是：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">TRIGGER</span><span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">觸發器名稱</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a61717;background-color:#e3d2d2">{</span><span style="color:#8b008b;font-weight:bold">BEFORE</span>|AFTER<span style="color:#a61717;background-color:#e3d2d2">}</span><span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">{</span><span style="color:#8b008b;font-weight:bold">INSERT</span>|<span style="color:#8b008b;font-weight:bold">UPDATE</span>|<span style="color:#8b008b;font-weight:bold">DELETE</span><span style="color:#a61717;background-color:#e3d2d2">}</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">ON</span><span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">表名</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">FOR</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">EACH</span><span style="color:#bbb"> </span>ROW<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a61717;background-color:#e3d2d2">觸發器執行的語句塊</span>;<span style="color:#bbb">
</span></span></span></code></pre></div><p>說明：</p>
<ul>
<li>
<p><code>表名</code>：表示觸發器監控的物件。</p>
</li>
<li>
<p><code>BEFORE|AFTER</code>：表示觸發的時間。BEFORE 表示在事件之前觸發；AFTER 表示在事件之後觸發。</p>
</li>
<li>
<p><code>INSERT|UPDATE|DELETE</code>：表示觸發的事件。</p>
<ul>
<li>INSERT 表示插入記錄時觸發；</li>
<li>UPDATE 表示更新記錄時觸發；</li>
<li>DELETE 表示刪除記錄時觸發。</li>
</ul>
</li>
<li>
<p><code>觸發器執行的語句塊</code>：可以是單條SQL語句，也可以是由BEGIN…END結構組成的複合陳述式塊。</p>
</li>
</ul>
<h3 id="22-代碼舉例">2.2 代碼舉例</h3>
<p><strong>舉例1：</strong></p>
<p>1、創建資料表：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">TABLE</span><span style="color:#bbb"> </span><span style="color:#008b45">test_trigger</span><span style="color:#bbb"> </span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>id<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">INT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">PRIMARY</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">KEY</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">AUTO_INCREMENT</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>t_note<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">VARCHAR</span>(<span style="color:#b452cd">30</span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">TABLE</span><span style="color:#bbb"> </span><span style="color:#008b45">test_trigger_log</span><span style="color:#bbb"> </span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>id<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">INT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">PRIMARY</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">KEY</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">AUTO_INCREMENT</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>t_log<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">VARCHAR</span>(<span style="color:#b452cd">30</span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>);<span style="color:#bbb">
</span></span></span></code></pre></div><p>2、創建觸發器：創建名稱為before_insert的觸發器，向test_trigger資料表插入資料之前，向test_trigger_log資料表中插入before_insert的日誌資訊。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>DELIMITER<span style="color:#bbb"> </span>//<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">TRIGGER</span><span style="color:#bbb"> </span>before_insert<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">BEFORE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">ON</span><span style="color:#bbb"> </span>test_trigger<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">FOR</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">EACH</span><span style="color:#bbb"> </span>ROW<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>BEGIN<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#8b008b;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">INTO</span><span style="color:#bbb"> </span><span style="color:#008b45">test_trigger_log</span><span style="color:#bbb"> </span>(t_log)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#8b008b;font-weight:bold">VALUES</span>(<span style="color:#cd5555">&#39;before_insert&#39;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>END<span style="color:#bbb"> </span>//<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>DELIMITER<span style="color:#bbb"> </span>;<span style="color:#bbb">
</span></span></span></code></pre></div><p>3、向test_trigger資料表中插入資料</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">INTO</span><span style="color:#bbb"> </span><span style="color:#008b45">test_trigger</span><span style="color:#bbb"> </span>(t_note)<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">VALUES</span><span style="color:#bbb"> </span>(<span style="color:#cd5555">&#39;測試 BEFORE INSERT 觸發器&#39;</span>);<span style="color:#bbb">
</span></span></span></code></pre></div><p>4、查看test_trigger_log資料表中的資料</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>mysql&gt;<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>*<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#bbb"> </span>test_trigger_log;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>+----+---------------+<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>|<span style="color:#bbb"> </span>id<span style="color:#bbb"> </span>|<span style="color:#bbb"> </span>t_log<span style="color:#bbb">         </span>|<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>+----+---------------+<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>|<span style="color:#bbb">  </span><span style="color:#b452cd">1</span><span style="color:#bbb"> </span>|<span style="color:#bbb"> </span>before_insert<span style="color:#bbb"> </span>|<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>+----+---------------+<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#b452cd">1</span><span style="color:#bbb"> </span>row<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">in</span><span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">set</span><span style="color:#bbb"> </span>(<span style="color:#b452cd">0</span>.<span style="color:#b452cd">00</span><span style="color:#bbb"> </span>sec)<span style="color:#bbb">
</span></span></span></code></pre></div><p><strong>舉例2：</strong></p>
<p>1、創建名稱為after_insert的觸發器，向test_trigger資料表插入資料之後，向test_trigger_log資料表中插入after_insert的日誌資訊。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>DELIMITER<span style="color:#bbb"> </span>//<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">TRIGGER</span><span style="color:#bbb"> </span>after_insert<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>AFTER<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">ON</span><span style="color:#bbb"> </span>test_trigger<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">FOR</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">EACH</span><span style="color:#bbb"> </span>ROW<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>BEGIN<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#8b008b;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">INTO</span><span style="color:#bbb"> </span><span style="color:#008b45">test_trigger_log</span><span style="color:#bbb"> </span>(t_log)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#8b008b;font-weight:bold">VALUES</span>(<span style="color:#cd5555">&#39;after_insert&#39;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>END<span style="color:#bbb"> </span>//<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>DELIMITER<span style="color:#bbb"> </span>;<span style="color:#bbb">
</span></span></span></code></pre></div><p>2、向test_trigger資料表中插入資料。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">INTO</span><span style="color:#bbb"> </span><span style="color:#008b45">test_trigger</span><span style="color:#bbb"> </span>(t_note)<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">VALUES</span><span style="color:#bbb"> </span>(<span style="color:#cd5555">&#39;測試 AFTER INSERT 觸發器&#39;</span>);<span style="color:#bbb">
</span></span></span></code></pre></div><p>3、查看test_trigger_log資料表中的資料</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>mysql&gt;<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>*<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#bbb"> </span>test_trigger_log;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>+----+---------------+<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>|<span style="color:#bbb"> </span>id<span style="color:#bbb"> </span>|<span style="color:#bbb"> </span>t_log<span style="color:#bbb">         </span>|<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>+----+---------------+<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>|<span style="color:#bbb">  </span><span style="color:#b452cd">1</span><span style="color:#bbb"> </span>|<span style="color:#bbb"> </span>before_insert<span style="color:#bbb"> </span>|<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>|<span style="color:#bbb">  </span><span style="color:#b452cd">2</span><span style="color:#bbb"> </span>|<span style="color:#bbb"> </span>before_insert<span style="color:#bbb"> </span>|<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>|<span style="color:#bbb">  </span><span style="color:#b452cd">3</span><span style="color:#bbb"> </span>|<span style="color:#bbb"> </span>after_insert<span style="color:#bbb">  </span>|<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>+----+---------------+<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#b452cd">3</span><span style="color:#bbb"> </span>rows<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">in</span><span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">set</span><span style="color:#bbb"> </span>(<span style="color:#b452cd">0</span>.<span style="color:#b452cd">00</span><span style="color:#bbb"> </span>sec)<span style="color:#bbb">
</span></span></span></code></pre></div><p>**舉例3：**定義觸發器&quot;salary_check_trigger&quot;，基於員工表&quot;employees&quot;的INSERT事件，在INSERT之前檢查將要添加的新員工薪資是否大於他領導的薪資，如果大於領導薪資，則報sqlstate_value為&rsquo;HY000&rsquo;的錯誤，從而使得添加失敗。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>DELIMITER<span style="color:#bbb"> </span>//<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">TRIGGER</span><span style="color:#bbb"> </span>salary_check_trigger<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">BEFORE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">INSERT</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">ON</span><span style="color:#bbb"> </span>employees<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">FOR</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">EACH</span><span style="color:#bbb"> </span>ROW<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>BEGIN<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#8b008b;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>mgrsalary<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">DOUBLE</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#8b008b;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>salary<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">INTO</span><span style="color:#bbb"> </span>mgrsalary<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#bbb"> </span>employees<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">WHERE</span><span style="color:#bbb"> </span>employee_id<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>NEW.manager_id;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#8b008b;font-weight:bold">IF</span><span style="color:#bbb"> </span>NEW.salary<span style="color:#bbb"> </span>&gt;<span style="color:#bbb"> </span>mgrsalary<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">THEN</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">		</span>SIGNAL<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">SQLSTATE</span><span style="color:#bbb"> </span><span style="color:#cd5555">&#39;HY000&#39;</span><span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">SET</span><span style="color:#bbb"> </span>MESSAGE_TEXT<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#cd5555">&#39;薪資高於領導薪資錯誤&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>END<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">IF</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>END<span style="color:#bbb"> </span>//<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>DELIMITER<span style="color:#bbb"> </span>;<span style="color:#bbb">
</span></span></span></code></pre></div><p>上面觸發器聲明過程中的NEW關鍵字代表INSERT添加語句的新記錄。</p>
<h2 id="3-查看刪除觸發器">3. 查看、刪除觸發器</h2>
<h3 id="31-查看觸發器">3.1 查看觸發器</h3>
<p>查看觸發器是查看資料庫中已經存在的觸發器的定義、狀態和語法資訊等。</p>
<p>方式1：查看當前資料庫的所有觸發器的定義</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">SHOW</span><span style="color:#bbb"> </span>TRIGGERS<span style="color:#a61717;background-color:#e3d2d2">\</span>G<span style="color:#bbb">
</span></span></span></code></pre></div><p>方式2：查看當前資料庫中某個觸發器的定義</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">SHOW</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">TRIGGER</span><span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">觸發器名</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>方式3：從系統庫information_schema的TRIGGERS表中查詢&quot;salary_check_trigger&quot;觸發器的資訊。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>*<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#bbb"> </span>information_schema.TRIGGERS;<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="32-刪除觸發器">3.2 刪除觸發器</h3>
<p>觸發器也是資料庫物件，刪除觸發器也用DROP語句，語法格式如下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">DROP</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">TRIGGER</span><span style="color:#bbb">  </span><span style="color:#8b008b;font-weight:bold">IF</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">EXISTS</span><span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">觸發器名稱</span>;<span style="color:#bbb">
</span></span></span></code></pre></div><h2 id="4-觸發器的優缺點">4. 觸發器的優缺點</h2>
<h3 id="41-優點">4.1 優點</h3>
<p><strong>1、觸發器可以確保資料的完整性</strong>。</p>
<p>假設我們用<code>進貨單頭表</code>（demo.importhead）來保存進貨單的總體資訊，包括進貨單編號、供應商編號、倉庫編號、總計進貨數量、總計進貨金額和驗收日期。</p>
<p>用<code>進貨單明細表</code>（demo.importdetails）來保存進貨商品的明細，包括進貨單編號、商品編號、進貨數量、進貨價格和進貨金額。</p>
<p>每當我們錄入、刪除和修改一條進貨單明細資料的時候，進貨單明細表裡的資料就會發生變動。這個時候，在進貨單頭表中的總計數量和總計金額就必須重新計算，否則，進貨單頭表中的總計數量和總計金額就不等於進貨單明細表中數量合計和金額合計了，這就是資料不一致。</p>
<p>為了解決這個問題，我們就可以使用觸發器，<strong>規定每當進貨單明細表有資料插入、修改和刪除的操作時，自動觸發 2 步操作：</strong></p>
<p>1）重新計算進貨單明細表中的數量合計和金額合計；</p>
<p>2）用第一步中計算出來的值更新進貨單頭表中的合計數量與合計金額。</p>
<p>這樣一來，進貨單頭表中的合計數量與合計金額的值，就始終與進貨單明細表中計算出來的合計數量與合計金額的值相同，資料就是一致的，不會互相矛盾。</p>
<p><strong>2、觸發器可以説明我們記錄操作日誌。</strong></p>
<p>利用觸發器，可以具體記錄什麼時間發生了什麼。比如，記錄修改會員儲值金額的觸發器，就是一個很好的例子。這對我們還原操作執行時的具體場景，更好地定位問題原因很有幫助。</p>
<p><strong>3、觸發器還可以用在運算元據前，對資料進行合法性檢查。</strong></p>
<p>比如，超市進貨的時候，需要庫管錄入進貨價格。但是，人為操作很容易犯錯誤，比如說在錄入數量的時候，把條碼掃進去了；錄入金額的時候，看串了行，錄入的價格遠超售價，導致帳面上的巨虧……這些都可以通過觸發器，在實際插入或者更新操作之前，對相應的資料進行檢查，及時提示錯誤，防止錯誤資料進入系統。</p>
<h3 id="42-缺點">4.2 缺點</h3>
<p><strong>1、觸發器最大的一個問題就是可讀性差。</strong></p>
<p>因為觸發器存儲在資料庫中，並且由事件驅動，這就意味著觸發器有可能<code>不受應用層的控制</code>。這對系統維護是非常有挑戰的。</p>
<p>比如，創建觸發器用於修改會員儲值操作。如果觸發器中的操作出了問題，會導致會員儲值金額更新失敗。我用下面的代碼演示一下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>mysql&gt;<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">update</span><span style="color:#bbb"> </span>demo.membermaster<span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">set</span><span style="color:#bbb"> </span>memberdeposit=<span style="color:#b452cd">20</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">where</span><span style="color:#bbb"> </span>memberid<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#b452cd">2</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>ERROR<span style="color:#bbb"> </span><span style="color:#b452cd">1054</span><span style="color:#bbb"> </span>(<span style="color:#b452cd">42</span>S22):<span style="color:#bbb"> </span>Unknown<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">column</span><span style="color:#bbb"> </span><span style="color:#cd5555">&#39;aa&#39;</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">in</span><span style="color:#bbb"> </span><span style="color:#cd5555">&#39;field list&#39;</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>結果顯示，系統提示錯誤，欄位&quot;aa&quot;不存在。</p>
<p>這是因為，觸發器中的資料插入操作多了一個欄位，系統提示錯誤。可是，如果你不瞭解這個觸發器，很可能會認為是更新語句本身的問題，或者是會員資訊表的結構出了問題。說不定你還會給會員資訊表添加一個叫&quot;aa&quot;的欄位，試圖解決這個問題，結果只能是白費力。</p>
<p><strong>2、相關資料的變更，可能會導致觸發器出錯。</strong></p>
<p>特別是資料表結構的變更，都可能會導致觸發器出錯，進而影響資料操作的正常運行。這些都會由於觸發器本身的隱蔽性，影響到應用中錯誤原因排查的效率。</p>
<h3 id="43-注意點">4.3 注意點</h3>
<p>注意，如果在子表中定義了外鍵約束，並且外鍵指定了ON UPDATE/DELETE CASCADE/SET NULL子句，此時修改父表被引用的鍵值或刪除父表被引用的記錄行時，也會引起子表的修改和刪除操作，此時基於子表的UPDATE和DELETE語句定義的觸發器並不會被啟動。</p>
<p>例如：基於子表員工表（t_employee）的DELETE語句定義了觸發器t1，而子表的部門編號（did）欄位定義了外鍵約束引用了父表部門表（t_department）的主鍵列部門編號（did），並且該外鍵加了&quot;ON DELETE SET NULL&quot;子句，那麼如果此時刪除父表部門表（t_department）在子表員工表（t_employee）有匹配記錄的部門記錄時，會引起子表員工表（t_employee）匹配記錄的部門編號（did）修改為NULL，但是此時不會啟動觸發器t1。只有直接對子表員工表（t_employee）執行DELETE語句時才會啟動觸發器t1。</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">上次修改於 2021-12-28</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://yoziming.github.io/post/211229-agg-mysql-14/">
			下一篇<br>MySQL8新特性
                </a>
                
                
                
                <a class="older-posts" href="https://yoziming.github.io/post/211227-agg-mysql-12/">
			上一篇<br>變量、流程控制與游標
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                








<div id="waline"></div>
<script>
    new Waline({
        el: '#waline',
        path: location.pathname,
        serverURL: "https://waline-pn38gfwbz-yoziming.vercel.app/" ,
		lang: 'en-US',
		visitor: true,
		meta: ['nick', 'mail'],
    });
    </script>



            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Yoziming
	
</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
