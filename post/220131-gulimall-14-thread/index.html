<!DOCTYPE html>
<html><head>
<meta name="google-site-verification" content="XrwF-xUZWSGJVBBm7jM8vqemVqx--zo5Tb9d-Vr7BCc" />
<title>ç·šç¨‹æ± èˆ‡CompletableFutureç•°æ­¥ç·¨æ’</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="SpringBootå¾®æœå‹™é …ç›®ç­†è¨˜-14">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="ç·šç¨‹æ± èˆ‡CompletableFutureç•°æ­¥ç·¨æ’" />
<meta property="og:description" content="SpringBootå¾®æœå‹™é …ç›®ç­†è¨˜-14" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yoziming.github.io/post/220131-gulimall-14-thread/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-31T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-01-31T00:00:00+00:00" /><meta property="og:site_name" content="My Blog" />






<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ç·šç¨‹æ± èˆ‡CompletableFutureç•°æ­¥ç·¨æ’"/>
<meta name="twitter:description" content="SpringBootå¾®æœå‹™é …ç›®ç­†è¨˜-14"/>







<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  




<link rel="icon" href="https://yoziming.github.io/images/favicon.png">



<link rel="stylesheet" href="https://yoziming.github.io/scss/journal.min.3f72a5fc8f5b5dd732a4b476aced0eece2156958d9d414316494ddb10593ddf7.css" integrity="sha256-P3Kl/I9bXdcypLR2rO0O7OIVaVjZ1BQxZJTdsQWT3fc=" media="screen">



<link rel="stylesheet" href="https://yoziming.github.io/scss/dark-mode.min.f7c2efa7183435a6bd1842f91c541481c7a5137b5991629a870f24e4a516ad4b.css" integrity="sha256-98Lvpxg0Naa9GEL5HFQUgcelE3tZkWKahw8k5KUWrUs=" media="screen">


<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons");
</script>






  <script src="/js/toc.js"></script>











<script src="//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js"></script>





</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://yoziming.github.io/">
    
        <div class="nav-title">
            æŸšå­èŒ¶å®¤
        </div>
        
        <div class="nav-subtitle">
            ç´€éŒ„è‡ªå­¸å¤§å°äº‹
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/">
                é¦–é ğŸ 
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                æ¨™ç±¤ğŸ·ï¸
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                ç³»åˆ—æ–‡ğŸ“–
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/about-me">
                é—œæ–¼æˆ‘ğŸ£
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
ç§»æ¤è‡ª <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Yoziming
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- ç›®éŒ„ -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%9a%e7%b7%9a%e7%a8%8b" onclick="onNavClick(`#å¤šç·šç¨‹-nav`)" id="å¤šç·šç¨‹-nav">
									å¤šç·šç¨‹
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%88%9d%e5%a7%8b%e5%8c%96%e7%b7%9a%e7%a8%8b%e7%9a%844%e7%a8%ae%e6%96%b9%e5%bc%8f" onclick="onNavClick(`#åˆå§‹åŒ–ç·šç¨‹çš„4ç¨®æ–¹å¼-nav`)" id="åˆå§‹åŒ–ç·šç¨‹çš„4ç¨®æ–¹å¼-nav">
									åˆå§‹åŒ–ç·šç¨‹çš„4ç¨®æ–¹å¼
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%8d%80%e5%88%a5" onclick="onNavClick(`#å€åˆ¥-nav`)" id="å€åˆ¥-nav">
									å€åˆ¥
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%b7%9a%e7%a8%8b%e6%b1%a0%e7%9a%84%e5%84%aa%e5%8b%a2" onclick="onNavClick(`#ç·šç¨‹æ± çš„å„ªå‹¢-nav`)" id="ç·šç¨‹æ± çš„å„ªå‹¢-nav">
									ç·šç¨‹æ± çš„å„ªå‹¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%89%8b%e5%8b%95%e5%89%b5%e5%bb%ba%e7%b7%9a%e7%a8%8b%e6%b1%a0" onclick="onNavClick(`#æ‰‹å‹•å‰µå»ºç·šç¨‹æ± -nav`)" id="æ‰‹å‹•å‰µå»ºç·šç¨‹æ± -nav">
									æ‰‹å‹•å‰µå»ºç·šç¨‹æ± 
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e9%a0%86%e5%ba%8f" onclick="onNavClick(`#é †åº-nav`)" id="é †åº-nav">
									é †åº
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%af%84%e4%be%8b" onclick="onNavClick(`#ç¯„ä¾‹-nav`)" id="ç¯„ä¾‹-nav">
									ç¯„ä¾‹
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%b7%9a%e7%a8%8b%e6%b1%a0execute%e5%92%8csubmit%e5%8d%80%e5%88%a5" onclick="onNavClick(`#ç·šç¨‹æ± executeå’Œsubmitå€åˆ¥-nav`)" id="ç·šç¨‹æ± executeå’Œsubmitå€åˆ¥-nav">
									ç·šç¨‹æ± executeå’Œsubmitå€åˆ¥
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%9b%9b%e7%a8%ae%e7%b7%9a%e7%a8%8b%e6%b1%a0%e6%a8%a1%e6%9d%bf" onclick="onNavClick(`#å››ç¨®ç·šç¨‹æ± æ¨¡æ¿-nav`)" id="å››ç¨®ç·šç¨‹æ± æ¨¡æ¿-nav">
									å››ç¨®ç·šç¨‹æ± æ¨¡æ¿
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#completablefuture-%e7%95%b0%e6%ad%a5%e7%b7%a8%e6%8e%92" onclick="onNavClick(`#completablefuture-ç•°æ­¥ç·¨æ’-nav`)" id="completablefuture-ç•°æ­¥ç·¨æ’-nav">
									CompletableFuture ç•°æ­¥ç·¨æ’
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%8c%87%e6%b4%be%e4%bb%bb%e5%8b%99" onclick="onNavClick(`#æŒ‡æ´¾ä»»å‹™-nav`)" id="æŒ‡æ´¾ä»»å‹™-nav">
									æŒ‡æ´¾ä»»å‹™
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%8e%a5%e6%94%b6%e4%bb%bb%e5%8b%99%e8%bf%94%e5%9b%9e%e5%80%bc" onclick="onNavClick(`#æ¥æ”¶ä»»å‹™è¿”å›å€¼-nav`)" id="æ¥æ”¶ä»»å‹™è¿”å›å€¼-nav">
									æ¥æ”¶ä»»å‹™è¿”å›å€¼
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#handle%e6%96%b9%e6%b3%95" onclick="onNavClick(`#handleæ–¹æ³•-nav`)" id="handleæ–¹æ³•-nav">
									handleæ–¹æ³•
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e4%b8%b2%e8%a1%8c%e5%8c%96" onclick="onNavClick(`#ä¸²è¡ŒåŒ–-nav`)" id="ä¸²è¡ŒåŒ–-nav">
									ä¸²è¡ŒåŒ–
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%bd%99%e6%95%b4%e4%bb%bb%e5%8b%99" onclick="onNavClick(`#å½™æ•´ä»»å‹™-nav`)" id="å½™æ•´ä»»å‹™-nav">
									å½™æ•´ä»»å‹™
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%85%a9%e5%80%8b%e4%bb%bb%e5%8b%99%e5%bf%85%e9%a0%88%e9%83%bd%e5%ae%8c%e6%88%90" onclick="onNavClick(`#å…©å€‹ä»»å‹™å¿…é ˆéƒ½å®Œæˆ-nav`)" id="å…©å€‹ä»»å‹™å¿…é ˆéƒ½å®Œæˆ-nav">
									å…©å€‹ä»»å‹™å¿…é ˆéƒ½å®Œæˆ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%ba%8c%e8%80%85%e4%b8%ad%e6%9c%89%e4%b8%80%e5%80%8b%e5%ae%8c%e6%88%90" onclick="onNavClick(`#äºŒè€…ä¸­æœ‰ä¸€å€‹å®Œæˆ-nav`)" id="äºŒè€…ä¸­æœ‰ä¸€å€‹å®Œæˆ-nav">
									äºŒè€…ä¸­æœ‰ä¸€å€‹å®Œæˆ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%85%a8%e5%ae%8c%e6%88%90%e6%88%96%e8%87%b3%e5%b0%91%e4%b8%80%e5%80%8b" onclick="onNavClick(`#å…¨å®Œæˆæˆ–è‡³å°‘ä¸€å€‹-nav`)" id="å…¨å®Œæˆæˆ–è‡³å°‘ä¸€å€‹-nav">
									å…¨å®Œæˆæˆ–è‡³å°‘ä¸€å€‹
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%b0%8f%e7%b5%90" onclick="onNavClick(`#å°çµ-nav`)" id="å°çµ-nav">
									å°çµ
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/">
                    é¦–é ğŸ 
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    æ¨™ç±¤ğŸ·ï¸
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    ç³»åˆ—æ–‡ğŸ“–
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/about-me">
                    é—œæ–¼æˆ‘ğŸ£
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- ç›®éŒ„ -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%a4%9a%e7%b7%9a%e7%a8%8b" onclick="onNavClick(`#å¤šç·šç¨‹-nav`)" id="å¤šç·šç¨‹-nav">
									å¤šç·šç¨‹
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%88%9d%e5%a7%8b%e5%8c%96%e7%b7%9a%e7%a8%8b%e7%9a%844%e7%a8%ae%e6%96%b9%e5%bc%8f" onclick="onNavClick(`#åˆå§‹åŒ–ç·šç¨‹çš„4ç¨®æ–¹å¼-nav`)" id="åˆå§‹åŒ–ç·šç¨‹çš„4ç¨®æ–¹å¼-nav">
									åˆå§‹åŒ–ç·šç¨‹çš„4ç¨®æ–¹å¼
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%8d%80%e5%88%a5" onclick="onNavClick(`#å€åˆ¥-nav`)" id="å€åˆ¥-nav">
									å€åˆ¥
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%b7%9a%e7%a8%8b%e6%b1%a0%e7%9a%84%e5%84%aa%e5%8b%a2" onclick="onNavClick(`#ç·šç¨‹æ± çš„å„ªå‹¢-nav`)" id="ç·šç¨‹æ± çš„å„ªå‹¢-nav">
									ç·šç¨‹æ± çš„å„ªå‹¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%89%8b%e5%8b%95%e5%89%b5%e5%bb%ba%e7%b7%9a%e7%a8%8b%e6%b1%a0" onclick="onNavClick(`#æ‰‹å‹•å‰µå»ºç·šç¨‹æ± -nav`)" id="æ‰‹å‹•å‰µå»ºç·šç¨‹æ± -nav">
									æ‰‹å‹•å‰µå»ºç·šç¨‹æ± 
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e9%a0%86%e5%ba%8f" onclick="onNavClick(`#é †åº-nav`)" id="é †åº-nav">
									é †åº
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%af%84%e4%be%8b" onclick="onNavClick(`#ç¯„ä¾‹-nav`)" id="ç¯„ä¾‹-nav">
									ç¯„ä¾‹
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%b7%9a%e7%a8%8b%e6%b1%a0execute%e5%92%8csubmit%e5%8d%80%e5%88%a5" onclick="onNavClick(`#ç·šç¨‹æ± executeå’Œsubmitå€åˆ¥-nav`)" id="ç·šç¨‹æ± executeå’Œsubmitå€åˆ¥-nav">
									ç·šç¨‹æ± executeå’Œsubmitå€åˆ¥
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%9b%9b%e7%a8%ae%e7%b7%9a%e7%a8%8b%e6%b1%a0%e6%a8%a1%e6%9d%bf" onclick="onNavClick(`#å››ç¨®ç·šç¨‹æ± æ¨¡æ¿-nav`)" id="å››ç¨®ç·šç¨‹æ± æ¨¡æ¿-nav">
									å››ç¨®ç·šç¨‹æ± æ¨¡æ¿
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#completablefuture-%e7%95%b0%e6%ad%a5%e7%b7%a8%e6%8e%92" onclick="onNavClick(`#completablefuture-ç•°æ­¥ç·¨æ’-nav`)" id="completablefuture-ç•°æ­¥ç·¨æ’-nav">
									CompletableFuture ç•°æ­¥ç·¨æ’
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%8c%87%e6%b4%be%e4%bb%bb%e5%8b%99" onclick="onNavClick(`#æŒ‡æ´¾ä»»å‹™-nav`)" id="æŒ‡æ´¾ä»»å‹™-nav">
									æŒ‡æ´¾ä»»å‹™
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%8e%a5%e6%94%b6%e4%bb%bb%e5%8b%99%e8%bf%94%e5%9b%9e%e5%80%bc" onclick="onNavClick(`#æ¥æ”¶ä»»å‹™è¿”å›å€¼-nav`)" id="æ¥æ”¶ä»»å‹™è¿”å›å€¼-nav">
									æ¥æ”¶ä»»å‹™è¿”å›å€¼
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#handle%e6%96%b9%e6%b3%95" onclick="onNavClick(`#handleæ–¹æ³•-nav`)" id="handleæ–¹æ³•-nav">
									handleæ–¹æ³•
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e4%b8%b2%e8%a1%8c%e5%8c%96" onclick="onNavClick(`#ä¸²è¡ŒåŒ–-nav`)" id="ä¸²è¡ŒåŒ–-nav">
									ä¸²è¡ŒåŒ–
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%bd%99%e6%95%b4%e4%bb%bb%e5%8b%99" onclick="onNavClick(`#å½™æ•´ä»»å‹™-nav`)" id="å½™æ•´ä»»å‹™-nav">
									å½™æ•´ä»»å‹™
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%85%a9%e5%80%8b%e4%bb%bb%e5%8b%99%e5%bf%85%e9%a0%88%e9%83%bd%e5%ae%8c%e6%88%90" onclick="onNavClick(`#å…©å€‹ä»»å‹™å¿…é ˆéƒ½å®Œæˆ-nav`)" id="å…©å€‹ä»»å‹™å¿…é ˆéƒ½å®Œæˆ-nav">
									å…©å€‹ä»»å‹™å¿…é ˆéƒ½å®Œæˆ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%ba%8c%e8%80%85%e4%b8%ad%e6%9c%89%e4%b8%80%e5%80%8b%e5%ae%8c%e6%88%90" onclick="onNavClick(`#äºŒè€…ä¸­æœ‰ä¸€å€‹å®Œæˆ-nav`)" id="äºŒè€…ä¸­æœ‰ä¸€å€‹å®Œæˆ-nav">
									äºŒè€…ä¸­æœ‰ä¸€å€‹å®Œæˆ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%85%a8%e5%ae%8c%e6%88%90%e6%88%96%e8%87%b3%e5%b0%91%e4%b8%80%e5%80%8b" onclick="onNavClick(`#å…¨å®Œæˆæˆ–è‡³å°‘ä¸€å€‹-nav`)" id="å…¨å®Œæˆæˆ–è‡³å°‘ä¸€å€‹-nav">
									å…¨å®Œæˆæˆ–è‡³å°‘ä¸€å€‹
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%b0%8f%e7%b5%90" onclick="onNavClick(`#å°çµ-nav`)" id="å°çµ-nav">
									å°çµ
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://yoziming.github.io/">
            æŸšå­èŒ¶å®¤
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://yoziming.github.io/">
        <div class="single-column-header-title">æŸšå­èŒ¶å®¤</div>
        
        <div class="single-column-header-subtitle">ç´€éŒ„è‡ªå­¸å¤§å°äº‹</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://yoziming.github.io/images/thread.png')"
                    
                
            >
                <div class="post-title">
                    ç·šç¨‹æ± èˆ‡CompletableFutureç•°æ­¥ç·¨æ’
                    
                    <div class="post-subtitle">
                        SpringBootå¾®æœå‹™é …ç›®ç­†è¨˜-14
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2022-01-31 00:00
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/java%E5%BE%AE%E6%9C%8D%E5%8B%99%E5%B0%88%E6%A1%88">Javaå¾®æœå‹™å°ˆæ¡ˆ</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/java">Java</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h1 id="å¤šç·šç¨‹">å¤šç·šç¨‹</h1>
<h2 id="åˆå§‹åŒ–ç·šç¨‹çš„4ç¨®æ–¹å¼">åˆå§‹åŒ–ç·šç¨‹çš„4ç¨®æ–¹å¼</h2>
<ol>
<li>ç¹¼æ‰¿ Thread</li>
<li>å¯¦ç¾ Runnableæ¥å£</li>
<li>å¯¦ç¾ Callableæ¥å£ + FutureTaskï¼ˆå¯ä»¥æ‹¿åˆ°è¿”å›çµæœï¼Œå¯ä»¥è™•ç†ç•°å¸¸ï¼‰</li>
<li>ç·šç¨‹æ± </li>
</ol>
<blockquote>
<p>è¤‡ç¿’ <a href="https://yoziming.github.io/post/211204-agg-ja-19/">https://yoziming.github.io/post/211204-agg-ja-19/</a></p>
</blockquote>
<h3 id="å€åˆ¥">å€åˆ¥</h3>
<ul>
<li>1ã€2ä¸èƒ½å¾—åˆ°è¿”å›å€¼ã€‚3å¯ä»¥ç²å–è¿”å›å€¼</li>
<li>1ã€2ã€3éƒ½ä¸èƒ½æ§åˆ¶è³‡æº</li>
<li>4å¯ä»¥æ§åˆ¶è³‡æºï¼Œæ€§èƒ½ç©©å®šï¼Œä¸æœƒä¸€ä¸‹å­æ‰€æœ‰ç·šç¨‹ä¸€èµ·é‹è¡Œ</li>
<li>å¯¦éš›é–‹ç™¼ä¸­ï¼Œåªç”¨ç·šç¨‹æ± ï¼Œå› ç‚ºé«˜ä½µç™¼ç‹€æ…‹é–‹å•“äº†nå€‹ç·šç¨‹ï¼Œæœƒç›´æ¥è€—ç›¡è³‡æº</li>
</ul>
<h2 id="ç·šç¨‹æ± çš„å„ªå‹¢">ç·šç¨‹æ± çš„å„ªå‹¢</h2>
<ul>
<li>é™ä½è³‡æºçš„æ¶ˆè€—: çœå¾—åœ¨é‚£å‰µäº†åˆåˆªï¼Œåˆªäº†åˆå‰µ</li>
<li>æé«˜éŸ¿æ‡‰é€Ÿåº¦: å·²ç¶“åœ¨æ± å­é‚£ç­‰äº†ï¼Œä¾†æ´»å°±å¹¹</li>
<li>æé«˜ç·šç¨‹çš„å¯ç®¡ç†æ€§: ä¾‹å¦‚ç³»çµ±ä¸­å¯ä»¥å‰µå»ºå…©å€‹ç·šç¨‹æ± ï¼Œæ ¸å¿ƒç·šç¨‹æ± ã€éæ ¸å¿ƒç·šç¨‹æ± ï¼Œæœ‰éœ€è¦æ™‚å¯ä»¥é—œé–‰éæ ¸å¿ƒç·šç¨‹æ± é‡‹æ”¾è¨˜æ†¶é«”è³‡æº
<ul>
<li>å°±åƒå…¬å¸åˆ†å…©éƒ¨é–€ï¼Œå£“åŠ›å¤§å°±æŠŠéæ ¸å¿ƒçš„éƒ¨é–€é—œäº†</li>
</ul>
</li>
</ul>
<h2 id="æ‰‹å‹•å‰µå»ºç·šç¨‹æ± ">æ‰‹å‹•å‰µå»ºç·šç¨‹æ± </h2>
<p><img src="image-20220124093616789.png" alt="image-20220124093616789"></p>
<ul>
<li>å¯ä»¥<code>new ThreadPoolExecutor(åƒæ•¸)</code>æ‰‹å‹•å‰µå»ºç·šç¨‹æ± ï¼Œä¸ƒå¤§åƒæ•¸:</li>
</ul>
<pre tabindex="0"><code>// ThreadPoolExecutor.java åŸå§‹ç¢¼
corePoolSize â€“ the number of threads to keep in the pool, even if they are idle, unless allowCoreThreadTimeOut is set
maximumPoolSize â€“ the maximum number of threads to allow in the pool
keepAliveTime â€“ when the number of threads is greater than the core, this is the maximum time that excess idle threads will wait for new tasks before terminating.
unit â€“ the time unit for the keepAliveTime argument
workQueue â€“ the queue to use for holding tasks before they are executed. This queue will hold only the Runnable tasks submitted by the execute method.
threadFactory â€“ the factory to use when the executor creates a new thread
handler â€“ the handler to use when execution is blocked because the thread bounds and queue capacities are reached
</code></pre><ul>
<li>corePoolSize: å…ƒè€ç´šå“¡å·¥ï¼Œå³ä½¿æ‘¸é­šä¹Ÿä¸æœƒè¢«è§£é›‡</li>
<li>maximumPoolSize: æœ€å¤§æ‹›å‹Ÿæ•¸é‡ï¼Œç”¨æ–¼æ§åˆ¶è³‡æº</li>
<li>keepAliveTime: è‡¨æ™‚å“¡å·¥æ‘¸é­šå¤šä¹…å°±æŠŠä»–å€‘è§£é›‡</li>
<li>unit: è¨ˆç®—æ‘¸é­šæ™‚é–“çš„å–®ä½</li>
<li>workQueue: é˜»å¡éšŠåˆ—ï¼Œä»»å‹™å¤ªå¤šæš«æ™‚æ²’å“¡å·¥å¯åˆ†é…äº†ï¼Œæ–°ä¾†çš„ä»»å‹™æ’éšŠçš„åœ°æ–¹</li>
<li>threadFactory: å‰µå»ºåŸ·è¡Œç·’çš„å·¥å» ï¼Œçµ¦å“¡å·¥å‘½åçš„äººè³‡</li>
<li>handler: å¦‚æœéšŠåˆ—æ»¿äº†ï¼ŒåŸ·è¡ŒæŒ‡å®šçš„æ‹’çµ•ç­–ç•¥
<ul>
<li>RejectedExecutionHandler æœ‰ä»¥ä¸‹å¹¾ç¨®</li>
<li>é è¨­æ˜¯AbortPolicyï¼Œè·Ÿå®¢æˆ¶èªªå…¬å¸å¹¹ä¸éä¾†è«‹ä»–æ‰¾åˆ¥å®¶</li>
<li>CallerRunsPolicyé¡ä¼¼é–‹å°ç¶ï¼Œç¡¬å¹«ä½ åŸ·è¡Œ</li>
</ul>
</li>
</ul>
<p><img src="image-20220124090358219.png" alt="image-20220124090358219"></p>
<h3 id="é †åº">é †åº</h3>
<ul>
<li>å‰µå»ºç·šç¨‹æ± ï¼Œæ‡¶åŠ è¼‰æ ¸å¿ƒç·šç¨‹(ä»»å‹™ä¾†äº†å°±æ‹›å‹Ÿæ ¸å¿ƒå“¡å·¥)</li>
<li>æ ¸å¿ƒç·šç¨‹æ»¿æ”¾å…¥é˜»å¡éšŠåˆ—(å“¡å·¥ä¸å¤ ç”¨ï¼Œè«‹ä»»å‹™å…ˆæ’éšŠï¼Œé¦¬ä¸Šæ‹›è‡¨æ™‚å·¥)</li>
<li>å‰µå»ºç·šç¨‹ï¼Œç›´åˆ°é”åˆ°maximumPoolSize</li>
<li>å¦‚æœå‚³å…¥äº†æ‹’çµ•ç­–ç•¥æœƒåŸ·è¡Œï¼Œå¦å‰‡æ‹‹å‡ºç•°å¸¸</li>
</ul>
<h4 id="ç¯„ä¾‹">ç¯„ä¾‹</h4>
<ul>
<li>ä¸€å€‹ç·šç¨‹æ±  core = 7, max = 20, queue = 50 ç•¶100å€‹ä½µç™¼é€²ä¾†</li>
<li>7å€‹ä»»å‹™ç«‹å³è¢«æ ¸å¿ƒåŸ·è¡Œï¼Œ50å€‹é€²éšŠåˆ—ï¼Œç„¶å¾Œå‰µå»º13å€‹ç·šç¨‹åŸ·è¡Œ13å€‹ä»»å‹™ã€‚å‰©ä¸‹30å€‹åŸ·è¡Œæ‹’çµ•ç­–ç•¥</li>
</ul>
<h3 id="ç·šç¨‹æ± executeå’Œsubmitå€åˆ¥">ç·šç¨‹æ± executeå’Œsubmitå€åˆ¥</h3>
<ul>
<li>execute: åƒæ•¸åªèƒ½æ˜¯Runnableï¼Œæ²’æœ‰è¿”å›å€¼</li>
<li>submit: åƒæ•¸å¯ä»¥æ˜¯Runnableã€Callableï¼Œè¿”å›å€¼æ˜¯FutureTask</li>
</ul>
<h2 id="å››ç¨®ç·šç¨‹æ± æ¨¡æ¿">å››ç¨®ç·šç¨‹æ± æ¨¡æ¿</h2>
<p><img src="image-20220124093548225.png" alt="image-20220124093548225"></p>
<ul>
<li>CachedThreadPool: æ ¸å¿ƒç·šç¨‹æ•¸æ˜¯0ï¼Œå¦‚æœç©ºé–’æœƒå›æ”¶æ‰€æœ‰ç·šç¨‹ã€‚å…¨å“¡æ´¾é£å…¬å¸ï¼Œæ²’äº‹å¹¹å°±è£å“¡</li>
<li>FixedThreadPool: æ ¸å¿ƒç·šç¨‹æ•¸ = æœ€å¤§ç·šç¨‹æ•¸ã€‚ä½›å¿ƒå…¬å¸ï¼Œæ°¸ä¸æ‹‹æ£„å“¡å·¥ï¼Œä½†å ç”¨å°±å¤šã€ä¸éˆæ´»</li>
<li>ScheduledThreadPool: å®šæ™‚ä»»å‹™ç·šç¨‹æ± ï¼Œå¤šä¹…ä¹‹å¾ŒåŸ·è¡Œï¼Œå¯è¨­å®šæ ¸å¿ƒç·šç¨‹æ•¸ã€æœ€å¤§ç·šç¨‹æ•¸æ˜¯Integer.Maxã€‚é™å®šç‡Ÿæ¥­æ™‚é–“çš„å…¬å¸</li>
<li>SingleThreadPool: æ ¸å¿ƒèˆ‡æœ€å¤§éƒ½åªæœ‰ä¸€å€‹ï¼Œå¾Œå°å¾éšŠåˆ—ä¸­ç²å–ä»»å‹™ã€‚å€‹äººæ¥æ¡ˆå…¬å¸ï¼Œä¸€ä»¶ä¸€ä»¶å¹¹</li>
</ul>
<h1 id="completablefuture-ç•°æ­¥ç·¨æ’">CompletableFuture ç•°æ­¥ç·¨æ’</h1>
<blockquote>
<p>å°±åƒç‚ºäº†åšå’–å“©é£¯ï¼Œç™½ç±³åœ¨é›»é‹è’¸ï¼Œç´…è˜¿è””é›£ç†Ÿæå‰ä¸Ÿå»ç…®ï¼Œæˆ‘é‚„èƒ½ä¸€é‚Šåˆ‡é¦¬éˆ´è–¯ã€‚é¡ä¼¼vueçš„Promiseä¹Ÿæ˜¯ç‚ºäº†ç•°æ­¥ä»»å‹™</p>
</blockquote>
<ul>
<li>å› ç‚ºè¦å¯¦ç¾Runnableï¼Œæ‰€ä»¥å¹¾ä¹éƒ½æ˜¯ç”¨lambdaè¡¨é”å¼ä¾†ç¸®å¯«ï¼Œçœå¾—å¯«å¥½å¹¾è¡Œ</li>
</ul>
<h2 id="æŒ‡æ´¾ä»»å‹™">æŒ‡æ´¾ä»»å‹™</h2>
<blockquote>
<p>æŠŠç´…è˜¿è””ä¸Ÿå»é‹è£¡ç…®</p>
</blockquote>
<ul>
<li>CompletableFutureæä¾›äº†å››å€‹éœæ…‹æ–¹æ³•ä¾†å‰µå»ºä¸€å€‹ç•°æ­¥æ“ä½œ</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> Completab1eFuture&lt;Void&gt; <span style="color:#008b45">runAsync</span>(Runnable runnable)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> completableFuturecVoid&gt; <span style="color:#008b45">runAsync</span>(Runnable runnable<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>Executor executor)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> &lt;U&gt; CompletableFuture&lt;U&gt; <span style="color:#008b45">supplyAsync</span>(Supplier&lt;U&gt;supplier)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> &lt;U&gt; CompletableFuturecU&gt; <span style="color:#008b45">supplyAsync</span>(Supplier&lt;U&gt; supplier<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>Executor executor)
</span></span></code></pre></div><ul>
<li>å¯ä»¥å‚³å…¥è‡ªå®šç¾©ç·šç¨‹æ± ï¼Œå¦å‰‡ä½¿ç”¨é è¨­ç·šç¨‹æ± </li>
<li>runXXXæ²’æœ‰è¿”å›çµæœï¼ŒsupplyXxxæœ‰è¿”å›çµæœ
<ul>
<li>ç”¨<code>future.get()</code>ç²å–çµæœ</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ThreadTest</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> ExecutorService executor = Executors.<span style="color:#658b00">newFixedThreadPool</span>(10);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) <span style="color:#8b008b;font-weight:bold">throws</span> ExecutionException, InterruptedException {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main start ....&#34;</span>);
</span></span><span style="display:flex;"><span>        CompletableFuture&lt;Integer&gt; future = CompletableFuture.<span style="color:#658b00">supplyAsync</span>(ThreadTest::asyncFunction, executor);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main end.... result: &#34;</span> + future.<span style="color:#658b00">get</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">int</span> <span style="color:#008b45">asyncFunction</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;åŸ·è¡Œä»»å‹™ 1+1&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> 1 + 1;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="æ¥æ”¶ä»»å‹™è¿”å›å€¼">æ¥æ”¶ä»»å‹™è¿”å›å€¼</h2>
<blockquote>
<p>ç…®äº†ç´…è˜¿è””ä¹‹å¾Œè¦å¹¹å˜›</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> completableFuture&lt;T&gt; <span style="color:#008b45">whencomplete</span>(BiConsumer&lt;? <span style="color:#8b008b;font-weight:bold">super</span> T, ? <span style="color:#8b008b;font-weight:bold">super</span> Throwable&gt; action);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> completableFuture&lt;T&gt; <span style="color:#008b45">whenCompleteAsync</span>(BiConsumer&lt;? <span style="color:#8b008b;font-weight:bold">super</span> T, ? <span style="color:#8b008b;font-weight:bold">super</span> Throwable&gt; action<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>Executor executor);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> completableFuture&lt;T&gt; <span style="color:#008b45">exceptionally</span>(Function&lt;Throwable, ? <span style="color:#8b008b;font-weight:bold">extends</span> T&gt; fn);
</span></span></code></pre></div><ul>
<li>whenCompleteå¯ä»¥è™•ç†æ­£å¸¸çµæœå’Œæ„ŸçŸ¥ç•°å¸¸ï¼Œexceptionallyç‰¹åˆ¥ç”¨æ–¼è™•ç†ç•°å¸¸æƒ…æ³</li>
<li>whenCompleteå’ŒwhenCompleteAsyncçš„å€åˆ¥:
<ul>
<li>whenComplete: æ˜¯åŸ·è¡Œç•¶å‰ä»»å‹™çš„ç·šç¨‹åŸ·è¡Œç¹¼çºŒåŸ·è¡ŒwhenCompleteçš„ä»»å‹™</li>
<li>whenCompleteAsync: æ˜¯åŸ·è¡ŒæŠŠ whenCompleteAsyncé€™å€‹ä»»å‹™ç¹¼çºŒæäº¤çµ¦ç·šç¨‹æ± ä¾†é€²è¡ŒåŸ·è¡Œ</li>
</ul>
</li>
<li>æ–¹æ³•ä¸ä»¥Asyncçµå°¾ï¼Œæ„å‘³ç€Actionä½¿ç”¨ç›¸åŒçš„ç·šç¨‹åŸ·è¡Œï¼Œè€ŒAsyncå¯èƒ½æœƒä½¿ç”¨å…¶ä»–ç·šç¨‹åŸ·è¡Œï¼ˆå¦‚æœæ˜¯ä½¿ç”¨ç›¸åŒçš„ç·šç¨‹æ± ï¼Œä¹Ÿå¯èƒ½æœƒè¢«åŒä¸€å€‹ç·šç¨‹é¸ä¸­åŸ·è¡Œ)
<ul>
<li>å°±æ˜¯é€™å€‹é‹ç…®å®Œé€™æ‰¹ç´…è˜¿è””è¦ä¸è¦æ›å€‹é‹</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ThreadTest</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> ExecutorService executor = Executors.<span style="color:#658b00">newFixedThreadPool</span>(10);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) <span style="color:#8b008b;font-weight:bold">throws</span> ExecutionException, InterruptedException {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main start ...&#34;</span>);
</span></span><span style="display:flex;"><span>        CompletableFuture&lt;String&gt; future = CompletableFuture
</span></span><span style="display:flex;"><span>                .<span style="color:#658b00">supplyAsync</span>(ThreadTest::asyncFunction, executor)
</span></span><span style="display:flex;"><span>                .<span style="color:#658b00">whenComplete</span>(ThreadTest::accept)
</span></span><span style="display:flex;"><span>                .<span style="color:#658b00">exceptionally</span>(ThreadTest::apply);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main end... è¿”å›å€¼ï¼š&#34;</span> + future.<span style="color:#658b00">get</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// æŒ‡æ´¾ä»»å‹™
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> String <span style="color:#008b45">asyncFunction</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç·šç¨‹æ± åŸ·è¡Œä»»å‹™ ç…®ç´…è˜¿è””&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#00688b;font-weight:bold">int</span> i = 10 / 0; <span style="color:#228b22">// è®“ç•°å¸¸ç™¼ç”Ÿ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;ç…®å¥½äº†&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// æŒ‡æ´¾ä»»å‹™å®Œæˆå¾Œè¦å¹¹çš„äº‹
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">accept</span>(String result, Throwable exception) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç²å–ä»»å‹™1çš„çµæœï¼š&#34;</span> + result);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç²å–ä»»å‹™1çš„ç•°å¸¸ï¼š&#34;</span> + exception);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// ç•°å¸¸æ™‚è¦è¿”å›çš„
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> String <span style="color:#008b45">apply</span>(Throwable exception) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç´…è˜¿è””ç•°å¸¸&#34;</span> + exception);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;ç´…è˜¿è””æ²’ç†Ÿéœ€è¦é‡ç…®&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="handleæ–¹æ³•">handleæ–¹æ³•</h3>
<p>whenCompleteåªèƒ½æ„ŸçŸ¥ç•°å¸¸ï¼Œä»–åªèƒ½è·Ÿä½ èªªçµæœæ²’ç†Ÿï¼Œä½†æ˜¯ä¸èƒ½å°æ²’ç†Ÿçš„ç´…è˜¿è””æ€æ¨£ï¼Œå¤ªå¼±äº†æ‰€ä»¥é€šå¸¸ä¸ç”¨ã€‚é€šå¸¸æ˜¯ç”¨handle</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ThreadTest</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> ExecutorService executor = Executors.<span style="color:#658b00">newFixedThreadPool</span>(10);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) <span style="color:#8b008b;font-weight:bold">throws</span> ExecutionException, InterruptedException {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main start ...&#34;</span>);
</span></span><span style="display:flex;"><span>        CompletableFuture&lt;String&gt; future = CompletableFuture
</span></span><span style="display:flex;"><span>                .<span style="color:#658b00">supplyAsync</span>(ThreadTest::asyncFunction, executor)
</span></span><span style="display:flex;"><span>                .<span style="color:#658b00">whenComplete</span>(ThreadTest::accept)
</span></span><span style="display:flex;"><span>                .<span style="color:#658b00">exceptionally</span>(ThreadTest::apply)
</span></span><span style="display:flex;"><span>                .<span style="color:#658b00">handle</span>(ThreadTest::handle);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main end... è¿”å›å€¼ï¼š&#34;</span> + future.<span style="color:#658b00">get</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// æŒ‡æ´¾ä»»å‹™
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> String <span style="color:#008b45">asyncFunction</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç·šç¨‹æ± åŸ·è¡Œä»»å‹™ ç…®ç´…è˜¿è””&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#00688b;font-weight:bold">int</span> i = 10 / 0; <span style="color:#228b22">// è®“ç•°å¸¸ç™¼ç”Ÿ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;ç…®å¥½äº†&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// æŒ‡æ´¾ä»»å‹™å®Œæˆå¾Œè¦å¹¹çš„äº‹
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">accept</span>(String result, Throwable exception) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç²å–ä»»å‹™1çš„çµæœï¼š&#34;</span> + result);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç²å–ä»»å‹™1çš„ç•°å¸¸ï¼š&#34;</span> + exception);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// ç•°å¸¸æ™‚è¦è¿”å›çš„
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> String <span style="color:#008b45">apply</span>(Throwable exception) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç´…è˜¿è””ç•°å¸¸&#34;</span> + exception);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;ç´…è˜¿è””æ²’ç†Ÿéœ€è¦é‡ç…®&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> String <span style="color:#008b45">handle</span>(String result, Throwable exception) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç²å–ä»»å‹™1çš„çµæœï¼š&#34;</span> + result);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç²å–ä»»å‹™1çš„ç•°å¸¸ï¼š&#34;</span> + exception);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ç•°å¸¸ä¸æœƒå‚³æ’­ï¼Œå‰é¢èª¿ç”¨exceptionallyæ–¹æ³•è™•ç†äº†ç•°å¸¸&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> result + <span style="color:#cd5555">&#34;ï¼Œä¸¦ä¸”åŸºæ–¼ä»»å‹™1çš„çµæœï¼ŒæŠŠé‹è£¡çš„æ±è¥¿æ’ˆå‡ºä¾†&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="ä¸²è¡ŒåŒ–">ä¸²è¡ŒåŒ–</h2>
<blockquote>
<p>handleæ˜¯ç”¨æ–¼è™•ç†aæ–¹æ³•çš„çµæœï¼Œæ¥è‘—åŸ·è¡Œbæ–¹æ³•è¦ç”¨ä¸²è¡Œ</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> Completionstage&lt;Void&gt; <span style="color:#008b45">thenRun</span>(Runnable action);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> completionstage&lt;Void&gt; <span style="color:#008b45">thenAccept</span>(Consumer&lt;? <span style="color:#8b008b;font-weight:bold">super</span> T&gt; action);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> &lt;U&gt; CompletableFuturecU&gt; <span style="color:#008b45">thenApply</span>(Function&lt;? <span style="color:#8b008b;font-weight:bold">super</span> T,? <span style="color:#8b008b;font-weight:bold">extends</span> U&gt; fn)
</span></span></code></pre></div><ul>
<li>thenRunï¼šç¹¼çºŒåŸ·è¡Œï¼Œä¸æ¥å—ä¸Šä¸€å€‹ä»»å‹™çš„è¿”å›çµæœ</li>
<li>thenAcceptï¼šç¹¼çºŒåŸ·è¡Œï¼Œæ¥å—ä¸Šä¸€å€‹ä»»å‹™çš„è¿”å›çµæœ</li>
<li>thenApplyï¼šç¹¼çºŒåŸ·è¡Œï¼Œæ¥å—ä¸Šä¸€ä»»å‹™çš„è¿”å›çµæœï¼Œä¸¦ä¸”è‡ªå·±æœ‰è¿”å›å€¼</li>
<li>ä»–å€‘ä¹Ÿéƒ½æœ‰Asyncç‰ˆæœ¬ï¼Œè·Ÿå‰é¢ä¸€æ¨£å°±ä¸å¤šèªª</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) <span style="color:#8b008b;font-weight:bold">throws</span> ExecutionException, InterruptedException {
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main start ...&#34;</span>);
</span></span><span style="display:flex;"><span>    CompletableFuture&lt;String&gt; future = CompletableFuture
</span></span><span style="display:flex;"><span>            .<span style="color:#658b00">supplyAsync</span>(ThreadTest::asyncFunction, executor)
</span></span><span style="display:flex;"><span>            .<span style="color:#658b00">whenComplete</span>(ThreadTest::accept)
</span></span><span style="display:flex;"><span>            .<span style="color:#658b00">exceptionally</span>(ThreadTest::apply)
</span></span><span style="display:flex;"><span>            .<span style="color:#658b00">handle</span>(ThreadTest::handle)
</span></span><span style="display:flex;"><span>            .<span style="color:#658b00">thenApply</span>(ThreadTest::thenApply);
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main end... è¿”å›å€¼ï¼š&#34;</span> + future.<span style="color:#658b00">get</span>());
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> String <span style="color:#008b45">thenApply</span>(String result) {
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™2å•“å‹•&#34;</span>);
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™2å¯ä»¥ç²å–ä»»å‹™1çš„çµæœï¼š&#34;</span> + result);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;ç¾åœ¨æ›ç…®é¦¬éˆ´è–¯&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="å½™æ•´ä»»å‹™">å½™æ•´ä»»å‹™</h2>
<blockquote>
<p>ç¾åœ¨ç±³é£¯ã€å’–å“©ã€ç´…è˜¿è””ã€é¦¬éˆ´è–¯éƒ½ç…®äº†ï¼Œè¦ä¾†æ“ºç›¤</p>
</blockquote>
<h3 id="å…©å€‹ä»»å‹™å¿…é ˆéƒ½å®Œæˆ">å…©å€‹ä»»å‹™å¿…é ˆéƒ½å®Œæˆ</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> &lt;U,V&gt; CompletableFuture&lt;V&gt; <span style="color:#008b45">thenCombine</span>(CompletionStage&lt;? <span style="color:#8b008b;font-weight:bold">extends</span> U&gt; other, BiFunction&lt;? <span style="color:#8b008b;font-weight:bold">super</span> T,? <span style="color:#8b008b;font-weight:bold">super</span> U,? <span style="color:#8b008b;font-weight:bold">extends</span> V&gt; fn);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> &lt;U&gt; CompletableFuture&lt;Void&gt; <span style="color:#008b45">thenAcceptBoth</span>(CompletionStage&lt;? <span style="color:#8b008b;font-weight:bold">extends</span> U&gt; other, BiConsumer&lt;? <span style="color:#8b008b;font-weight:bold">super</span> T, ? <span style="color:#8b008b;font-weight:bold">super</span> U&gt; action);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> CompletableFuture&lt;Void&gt; <span style="color:#008b45">runAfterBoth</span>(CompletionStage&lt;?&gt; other, Runnable action);
</span></span></code></pre></div><ul>
<li>thenCombine: ç²å–å…©å€‹futureçš„è¿”å›çµæœï¼Œä¸¦è¿”å›ç•¶å‰ä»»å‹™çš„è¿”å›å€¼</li>
<li>thenAcceptBoth: ç²å–å…©å€‹futureä»»å‹™çš„è¿”å›çµæœï¼Œç„¶å¾Œè™•ç†ä»»å‹™ï¼Œæ²’æœ‰è¿”å›å€¼</li>
<li>runAfterBoth: ä¸éœ€è¦ç²å–futureçš„çµæœï¼Œåªéœ€å…©å€‹futureè™•ç†å®Œä»»å‹™å¾Œï¼Œè™•ç†è©²ä»»å‹™</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) <span style="color:#8b008b;font-weight:bold">throws</span> ExecutionException, InterruptedException {
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main start ...&#34;</span>);
</span></span><span style="display:flex;"><span>    CompletableFuture&lt;String&gt; future1 = CompletableFuture.<span style="color:#658b00">supplyAsync</span>(() -&gt; {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™1 ç…®ç´…è˜¿è””start..&#34;</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™1 end..&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;ç´…è˜¿è””ç…®å¥½äº†&#34;</span>;
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    CompletableFuture&lt;String&gt; future2 = CompletableFuture.<span style="color:#658b00">supplyAsync</span>(() -&gt; {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™2 ç…®é¦¬éˆ´è–¯start..&#34;</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™2 end..&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;é¦¬éˆ´è–¯ç…®å¥½äº†&#34;</span>;
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    CompletableFuture&lt;String&gt; future3 = future1.<span style="color:#658b00">thenCombineAsync</span>(future2, (result1, result2) -&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;ä»»å‹™3 çµ„åˆå‰å…©å€‹ä»»å‹™çš„è¿”å›å€¼è¿”å›: &#34;</span> + result1 + <span style="color:#cd5555">&#34;ä¸”&#34;</span> + result2;
</span></span><span style="display:flex;"><span>    }, executor);
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main end... è¿”å›å€¼ï¼š&#34;</span> + future3.<span style="color:#658b00">get</span>());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="äºŒè€…ä¸­æœ‰ä¸€å€‹å®Œæˆ">äºŒè€…ä¸­æœ‰ä¸€å€‹å®Œæˆ</h3>
<blockquote>
<p>æ‡‰è©²å¾ˆå°‘ç”¨åˆ°ï¼Œäº†è§£å°±å¥½</p>
</blockquote>
<ul>
<li>applyToEither: å¸¶åƒæœ‰è¿”å›å€¼ï¼Œèƒ½ç²å–å‰é¢ä»»å‹™çš„çµæœ(æˆåŠŸçš„é‚£å€‹)ï¼Œè‡ªå·±æœ‰è¿”å›çµæœ</li>
<li>acceptEither: å¸¶åƒç„¡è¿”å›å€¼ï¼Œèƒ½ç²å–å‰é¢ä»»å‹™çš„çµæœ</li>
<li>runAfterEither: ç„¡åƒç„¡è¿”å›å€¼ï¼Œä¸èƒ½ç²å–å‰é¢ä»»å‹™çš„çµæœï¼Œè‡ªå·±ä¹Ÿæ²’æœ‰è¿”å›çµæœ(è¦ä½ ä½•ç”¨)</li>
</ul>
<h3 id="å…¨å®Œæˆæˆ–è‡³å°‘ä¸€å€‹">å…¨å®Œæˆæˆ–è‡³å°‘ä¸€å€‹</h3>
<ul>
<li>
<p>éƒ½æ˜¯CompletableFutureçš„éœæ…‹æ–¹æ³•</p>
<ul>
<li>
<p>allOf</p>
</li>
<li>
<p>anyOf</p>
</li>
</ul>
</li>
<li>
<p>é…åˆ<code>.get()</code>å¯ä»¥è®“ç·šç¨‹é˜»å¡</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ThreadTest</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> ExecutorService executor = Executors.<span style="color:#658b00">newFixedThreadPool</span>(10);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) <span style="color:#8b008b;font-weight:bold">throws</span> ExecutionException, InterruptedException {
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main start ...&#34;</span>);
</span></span><span style="display:flex;"><span>        CompletableFuture&lt;String&gt; future1 = CompletableFuture.<span style="color:#658b00">supplyAsync</span>(() -&gt; {
</span></span><span style="display:flex;"><span>            System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™1 ç…®ç´…è˜¿è””start..&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>                Thread.<span style="color:#658b00">sleep</span>(3000);
</span></span><span style="display:flex;"><span>            } <span style="color:#8b008b;font-weight:bold">catch</span> (InterruptedException e) {
</span></span><span style="display:flex;"><span>                e.<span style="color:#658b00">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™1 end..&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;ç´…è˜¿è””ç…®å¥½äº†&#34;</span>;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        CompletableFuture&lt;String&gt; future2 = CompletableFuture.<span style="color:#658b00">supplyAsync</span>(() -&gt; {
</span></span><span style="display:flex;"><span>            System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™2 ç…®é¦¬éˆ´è–¯start..&#34;</span>);
</span></span><span style="display:flex;"><span>            System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™2 end..&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;é¦¬éˆ´è–¯ç…®å¥½äº†&#34;</span>;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        CompletableFuture&lt;String&gt; future3 = future1.<span style="color:#658b00">thenCombineAsync</span>(future2, (result1, result2) -&gt; {
</span></span><span style="display:flex;"><span>            System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™3 çµ„åˆé…èœï¼Œéœ€è¦é…èœéƒ½ç…®ç†Ÿ&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>                Thread.<span style="color:#658b00">sleep</span>(3000);
</span></span><span style="display:flex;"><span>            } <span style="color:#8b008b;font-weight:bold">catch</span> (InterruptedException e) {
</span></span><span style="display:flex;"><span>                e.<span style="color:#658b00">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;ä»»å‹™3 end..&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;é…èœå®Œæˆ&#34;</span>;
</span></span><span style="display:flex;"><span>        }, executor);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        CompletableFuture&lt;Void&gt; all = CompletableFuture.<span style="color:#658b00">allOf</span>(future1, future2, future3);
</span></span><span style="display:flex;"><span>        all.<span style="color:#658b00">get</span>(); <span style="color:#228b22">// ä½¿æ–¹æ³•é˜»å¡ï¼Œä¸é˜»å¡è‹¥æœ‰äººè¶…æ™‚ï¼Œä¸»ç·šç¨‹æœƒæå‰é—œé–‰
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(future1.<span style="color:#658b00">get</span>() + future2.<span style="color:#658b00">get</span>() + future3.<span style="color:#658b00">get</span>());
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;main end...&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="å°çµ">å°çµ</h1>
<ul>
<li>å¯¦éš›éƒ½ç”¨ç·šç¨‹æ± ï¼Œçœè³‡æºã€åæ‡‰å¿«ã€å¥½æ§åˆ¶</li>
<li>ç·šç¨‹æ± ä¸ƒåƒæ•¸:
<ul>
<li>core: æ ¸å¿ƒå“¡å·¥ï¼Œå‰µäº†å°±ä¸æ»…</li>
<li>max: æœ€å¤§å“¡å·¥æ•¸é‡(å«è‡¨æ™‚å·¥)</li>
<li>factory: å·¥å» ï¼Œäººè³‡</li>
<li>aliveTime: è‡¨æ™‚å·¥éæœŸæ™‚é–“</li>
<li>unit: éæœŸæ™‚é–“å–®ä½</li>
<li>queue: ä»»å‹™æ’éšŠè™•</li>
<li>handler: æ‹’çµ•ç­–ç•¥</li>
</ul>
</li>
<li>ä½µç™¼é€²ä¾†ï¼Œæ ¸å¿ƒæ¥æ´»ã€å»æ’éšŠã€æ“´å¤§æ± å­è‡¨æ™‚å·¥æ¥æ´»ç›´åˆ°maxï¼Œè¶…å‡ºçš„ä¾ç…§æ‹’çµ•ç­–ç•¥è¾¦äº‹</li>
<li>CompletableFuture:
<ul>
<li>Acceptå°±æ˜¯ç´”æ¥æ”¶çµæœ</li>
<li>Applyæ˜¯æ¥æ”¶çµæœï¼Œä¸”è‡ªå·±ä¹Ÿæœ‰çµæœ</li>
<li>Runå°±æ˜¯ä¸ç®¡ä¸Šä¸€å€‹çµæœï¼Œç¾åœ¨åšé€™ä»¶äº‹</li>
<li><code>get()</code>æ–¹æ³•å¯ä»¥è®“ç·šç¨‹é˜»å¡</li>
</ul>
</li>
</ul>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">ä¸Šæ¬¡ä¿®æ”¹æ–¼ 2022-01-31</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://yoziming.github.io/post/220201-gulimall-15/">
			ä¸‹ä¸€ç¯‡<br>å•†å“è©³æƒ…
                </a>
                
                
                
                <a class="older-posts" href="https://yoziming.github.io/post/220130-gulimall-13/">
			ä¸Šä¸€ç¯‡<br>ç”¨ElasticSearchå¯¦ç¾å•†å“æœç´¢
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                








<div id="waline"></div>
<script>
    new Waline({
        el: '#waline',
        path: location.pathname,
        serverURL: "https://waline-pn38gfwbz-yoziming.vercel.app/" ,
		lang: 'en-US',
		visitor: true,
		meta: ['nick', 'mail'],
    });
    </script>



            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
ç§»æ¤è‡ª <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Yoziming
	
</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
